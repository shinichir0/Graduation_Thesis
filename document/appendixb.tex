\chapter{HTMの実装}
実装時に用いたHTMのパラメータは以下の表の通りである。

\begin{table}[hbtp]
  \caption{HTMのパラメータ}
  \label{impl_htm_parameter}
  \centering
  \begin{tabular}{c|r}
    パラメータ名 & 値 \\
    \hline \hline
    カラム数 & 512 \\
    1カラム内のセル数 & 16 \\
    １セル内の接続セグメント数 & 32 \\
    予測状態に遷移するのに必要な接続セグメント & 4 \\
    セルの接続値の初期値 & 0.21 \\
    セルにおける接続のしきい値 & 0.5 \\
    接続値を増やす場合の更新式 & 0.1 \\
    接続値を減らす場合の更新式 & 0.1 \\
    予測状態にあったが活性化しなかったセルにおける更新式 & 0.01 \\
    1ステップ内で新たに持てる接続値の最大数 & 32 \\
    \hline
  \end{tabular}
\end{table}


提案モデルと従来型HTMの両方においてpythonによるスクラッチ実装を行った。
ライブラリはnumpyとpytorchのみでpytorchはSparseTensorのみを用いた。
HTMの活性化状態のセルと予測状態のセルはともに疎な分散表現となるためSparseTensorを用いて実装した。
また活性化状態のセルと予測状態のセルからカラム単位での活性化状態の遷移を記録し、それを用いて学習の分岐を行った。
セグメント集合は従来型は５次元、提案モデルは６次元のテンソルを正規分布によってランダムに初期化して用いた。
