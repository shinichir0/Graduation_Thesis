\chapter{はじめに}
近年では機械学習の研究が盛んになり，翻訳などに代表される文章の生成や，単語を表す分散表現など，様々なタスクに使用されている．その中の1つに画像認識というタスクが存在し，画像認識に用いられる事が多いConvolutional Neural Network(CNN)\cite{cnn}の認識精度は年々向上している．2015年には，その認識精度は人間を超えたと言われている\cite{fujitsu}．
%http://yann.lecun.org/exdb/publis/pdf/lecun-89e.pdf
%http://journal.jp.fujitsu.com/2015/10/02/01/

更に近年では，学習したデータにはない未知のデータを作成するなど，コンピュータにクリエイティブなタスクを行わせる研究も盛んになりつつある．その中の1つに画像生成というタスクが存在し，画像を生成出来る事により，デザインなどを具体的に思案する事が可能になるという長所がある．

画像生成タスクで使用されるネットワークは，主に2つに分類する事が出来る．

1つは画風変換と呼ばれるアルゴリズムを用いて画像を生成するもので，画像をCNNに入力し，畳込み層を何層か経た後の特徴マップを足しあわせる事で画像生成を行う．具体的な研究としては，Neural Style\cite{neuralstyle}という研究が存在する．
%https://arxiv.org/abs/1508.06576
入力としてコンテンツ画像とスタイル画像の，2枚の画像を必要とし，コンテンツ画像にスタイル画像の画風を足した画像を生成する．この処理に，CNNで畳みこんだ特徴マップを使用する事で，自然な画像を生成する事が可能になる．このアルゴリズムでは，あらかじめネットワークを学習させる必要はないが，1枚の画像を生成する度に学習を必要とするため，画像を生成する事に時間がかかるという問題がある．

もう１つはDeconvolutionと呼ばれる処理を行うもので，Deconvolution処理を用いたネットワークとしてDeep Convolutional Generative Adversarial Network(DCGAN)\cite{dcgan}などが有名である．DCGANは生成部と呼ばれる，CNNの入出力を入れ替えたような構造のDeconvolutional Networkと，識別部と呼ばれるCNNから成り立っており，乱数を入力とし画像を出力する．2016年に入ってDCGANを応用した研究として，解釈文を入力として画像を生成する研究\cite{fromcaption}などが発表された．
%https://arxiv.org/abs/1605.05396
このアルゴリズムでは，あらかじめネットワークを学習させる必要があり，また学習には大量の画像が必要となる．しかし，ネットワークを学習させた後は，画像を生成する事に時間がかからない．また，DCGANは乱数を入力とするため，画像はランダムにより生成され，指向性を持った画像生成を行うためには工夫が必要である．

本研究では，上記で説明したDeconvolutional Networkによる画像生成タスクに着目した．画像生成を行うネットワークの学習には大量の画像を必要とするため，既存のデータセットを使用する事にした．本研究では，顔画像のデータセットを用いて，顔画像生成を行う．指向性を持った画像生成を実現するため，画像を入力し，その画像に属性を付与した画像生成を行う．

顔画像生成の既存研究として，属性単語を入力として顔画像を生成する研究\cite{attr2image}や，画風変換アルゴリズムを使用して顔画像を生成する研究\cite{dfi}が存在する．属性とは，その画像が持っている特性を意味し，顔画像においては``笑顔''や``メガネ''，``口ひげ''などが挙げられる．Deconvolutional Networkによる顔画像生成は，モデルの基本的な構造を変える事なく，顔画像以外への応用など，様々な事への応用が可能であり，指向性をもった画像生成を行うことができる．そこで本研究では，Deconvolution処理を用いた，属性を付与した顔画像生成を提案する．
%https://arxiv.org/abs/1512.00570
%https://arxiv.org/abs/1611.05507

学習に用いるデータセットにはCelebA\cite{liu2015faceattributes}という著名人の顔画像20万2599枚を使用した．CelebAは40種類の属性がラベル付けしてあるデータセットで，本研究でもこの40種類の属性を使用した．CelebAデータセットをシステムで使用するための前処理として，画像をリサイズする必要があったため，解像度を保ったまま拡大するシステムであるCl-waifu2x\cite{waifu2x}を使用した．提案システムでは画像の特徴量を入力とし，属性特徴量を加算し，顔画像を生成する．入力に用いる画像特徴量の抽出には，CNNの一種であるVGG-19モデル\cite{vgg}を使用した．VGGモデルはIMAGENET Large Scale Visual Recognition Challenge(ILSVRC)\cite{imagenet}で高精度を残しており，19層からなるCNNである．加算する属性特徴量の作成には，データセットの属性ラベルとコサイン類似度を用いた．ラベル情報とコサイン類似度を利用して属性を持つ画像・属性を持たない画像の組を抽出し，その画像特徴量の差を属性特徴量とした．属性を持たない画像の特徴量を入力とし，属性を持つ画像を生成するように提案モデルを学習させ，学習データにない画像を用いて実験を行った．

本研究の評価として，入力画像と似ている画像が生成できているか，生成した画像に属性情報が付与されているかなどの項目について評価実験を行った．

以下，第２章で属性を付与した画像生成システムについて，第3章で評価実験，第4章で結論を述べる．
