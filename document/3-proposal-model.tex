\chapter{時間軸セグメントを導入したHTM}
\section{提案モデルの概要}
従来のHTMは１つ前の時刻におけるパターンを表現するセルのみとの接続を持つように学習していたが、前章で述べたように長期依存考慮を要する予測タスクに対して脆弱性があった。
そのためHTMの性能を改善するためにHTMに時間軸セグメントを導入することによって、複数前の時刻におけるパターンを表現するセルとの接続も持つように学習させた。

この改良の重要な点は新たに接続をもつようになった時刻の範囲においてのみに長期依存関係を保持できるようになったということではない。
HTMの学習において予測状態に遷移するセルに関して適切な密度を保持し続けることは重要な要素であるが、改良したHTMは複数前の時刻にわたって接続を学習することによってセルの状態遷移が安定して行われるために、新たに接続を持つようになった時刻の範囲をはるかに超える長期依存考慮が可能になった。

具体的に前章で挙げた以下の２つの問題点に関する改良について述べる。

\begin{itemize}
  \item 疎な分散表現を用いたために発火するセルが徐々に少なくなり消失する。
  \item 学習が大きく進んだパターンにおいて表現が疎になった時に次のパターンに繋がっていたセルが消失するために学習が損失する。
\end{itemize}

まず１つ目の問題に関しては複数前の時刻における活性化状態とそれらのセルとの接続セグメントを用いて予測状態のセルの計算を行い、それによるすべての予測状態のセルを予測に用いるためにセルの減少が抑制されている。

次に２つ目の問題に関しては学習が大きく進んだパターンにおいて表現が疎になった場合でも複数の時刻にわたる接続があるために次のパターンを予測するための学習が複数の時刻間に分散されているために学習の損失が抑制されている。

以上の２つの問題点に抑制によって長期依存考慮に関する性能が向上した。

\section{提案モデルの構造}
\subsection{従来型と同じ部分}

HTM全体の構造やセルの状態遷移、パターンの表現は従来のHTMを用いた。

\subsection{セル内の構造}

\begin{figure}[ht]
  \begin{center}
    \includegraphics[width=14cm]{./fig/drawing_9}
    \caption{提案モデルにおけるセル内の構造}
    \label{fig:HTM_improved}
  \end{center}
\end{figure}

提案モデルのセル内の構造は以上のようになっている。
入力セグメントは従来型のHTMと同様になっているが、セグメント集合の構造は異なっている。
セグメント集合内の接続セグメントに関して時間軸を導入した。
これによって接続セグメントはHTM中のすべてのセルとの接続値と時間軸の３次元ベクトル値となる。そのためセグメント集合は４次元のベクトル値となる。

\section{提案モデルの学習アルゴリズム}
提案モデルは従来のHTMを拡張しているため学習アルゴリズムにおいても拡張した部分がある。
時間軸を導入したことによって予測状態のセル計算とセグメント集合を用いた接続値の更新において変更点がある。

\subsubsection{従来型と同じ部分}

活性化状態のセルの計算に関しては従来のHTMと同様である。

\subsection{予測状態のセルの計算}

\subsection{セグメント集合を用いた接続値の更新}
